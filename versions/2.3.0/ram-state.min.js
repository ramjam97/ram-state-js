/*!
 * RamStateJs v2.3.0
 * Description: RamStateJs is a lightweight state management library for vanilla JavaScript. It provides a simple API to manage local and global state with watchers, effects, and DOM binding, inspired by Reactâ€™s useState and useEffect.
 * Author: Ram Jam
 * GitHub: https://github.com/ramjam97/ram-state-js
 * Build Date: 2025-09-12 15:45:20 (Asia/Manila)
 */
function RamState(e={}){const n=new Set,t=[],a=(e,n)=>{if(e===n)return!0;if(typeof e!=typeof n)return!1;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every((e,t)=>a(e,n[t]));if(e&&n&&"object"==typeof e){const t=Object.keys(e),l=Object.keys(n);return t.length===l.length&&t.every(t=>a(e[t],n[t]))}return!1},l=(e,n)=>{try{const t=n?e(n):e();return"function"==typeof t?t:null}catch(e){return console.error("RamState callback error:",e),null}},c=e=>{try{"function"==typeof e&&e()}catch(e){console.error("RamState cleanup error:",e)}},o=(e,n=!0)=>{t.forEach(({run:t,deps:a})=>{(null===a||n&&a.length>0&&a.includes(e))&&t()})};return(e.debug??1)&&console.log("RamState v2.3.0 initialized ðŸš€"),{useState:function(e,t=null){let s=e;const u={always:[],onChange:[]},i=t?document.querySelector(t):null;i&&(h(i,s),i.addEventListener("input",()=>{const e=f(i);p.set(e)}),i.addEventListener("change",()=>{const e=f(i);p.set(e)}));const r=e=>({dom:i,value:s,hasChange:e}),d=()=>({dom:i,value:s});function f(e){return e instanceof HTMLInputElement?"checkbox"===e.type?e.checked:e.value:e instanceof HTMLSelectElement?e.multiple?[...e.selectedOptions].map(e=>e.value):e.value:e instanceof HTMLTextAreaElement?e.value:null}function h(e,n){e instanceof HTMLInputElement?"checkbox"===e.type?e.checked=!!n:e.value=n??"":e instanceof HTMLSelectElement?e.multiple&&Array.isArray(n)?[...e.options].forEach(e=>{e.selected=n.includes(e.value)}):e.value=n??"":e instanceof HTMLTextAreaElement&&(e.value=n??"")}const p={dom:i,get value(){return s},set(e){"function"==typeof e&&(e=e(s));const n=!a(s,e);return s=e,i&&h(i,s),u.always.forEach(e=>{c(e.cleanup),e.cleanup=l(e.cb,r(n))}),n&&u.onChange.forEach(e=>{c(e.cleanup),e.cleanup=l(e.cb,d())}),o(p,n),s},watch(e,n=!1){if("function"!=typeof e)return void console.warn("watch callback must be a function");const t={cb:e,cleanup:null};n&&(t.cleanup=l(e,r(!1))),u.always.push(t)},watchEffect(e,n=!1){if("function"!=typeof e)return void console.warn("watchEffect callback must be a function");const t={cb:e,cleanup:null};n&&(t.cleanup=l(e,d())),u.onChange.push(t)}};return n.add(p),p},useEffect:function(e,n=null){if("function"!=typeof e)return void console.warn("useEffect callback must be a function");let a;const o={deps:n,run(){c(a),a=l(e)}};t.push(o),o.run()},useMemo:function(e,n=[]){let t,a={onChange:[]};const s=()=>({value:t});function u(){return t=e(),a.onChange.forEach(e=>{c(e.cleanup),e.cleanup=l(e.cb,s())}),o(i,!0),t}n.forEach(e=>e?.watchEffect(()=>u()));const i={get value(){return t},watchEffect(e){if("function"!=typeof e)return void console.warn("watchEffect callback must be a function");const n={cb:e,cleanup:null};n.cleanup=l(e,s()),a.onChange.push(n)}};return u(),i},useButton:function(e,t={}){const s={state:{disabled:t?.state?.disabled??!1,loading:t?.state?.loading??!1},disabled:{class:t?.disabled?.class??"disabled"},loading:{html:t?.loading?.html??"",icon:t?.loading?.icon??"",class:t?.loading?.class??"loading"}},u=[...e instanceof HTMLElement?[e]:"string"==typeof e?Array.from(document.querySelectorAll(e)):[]].map(e=>("function"==typeof s.loading.html&&(s.loading.html=s.loading.html(e.innerHTML)),{el:e,default:{html:e.innerHTML},loading:{html:s.loading.html||e.innerHTML,icon:s.loading.icon,class:s.loading.class},disabled:{class:s.disabled.class}})),i=u.map(e=>e.el);let r={disabled:s.state.disabled,loading:s.state.loading};const d={always:[],onChange:[]},f=e=>({dom:i,state:r,hasChange:e}),h=()=>({dom:i,state:r});function p(e){const n=!a(r,e);var t;return r=e,t=r,u.forEach(e=>{const{el:n}=e,a=e.default,l=e.loading,c=e.disabled;n.disabled=t.disabled||t.loading,n.classList.toggle(l.class,t.loading),n.classList.toggle(c.class,t.disabled),n.innerHTML=(t.loading?l.html:a.html)+(t.loading?l.icon:"")}),d.always.forEach(e=>{c(e.cleanup),e.cleanup=l(e.cb,f(n))}),n&&d.onChange.forEach(e=>{c(e.cleanup),e.cleanup=l(e.cb,h())}),o(g,n),r}const g={dom:i,get value(){return r},disabled:(e=!0)=>p({...r,disabled:e}),loading:(e=!0)=>p({...r,loading:e,disabled:e}),watch(e,n=!1){if("function"!=typeof e)return void console.warn("watch callback must be a function");const t={cb:e,cleanup:null};n&&(t.cleanup=l(e,f(!1))),d.always.push(t)},watchEffect(e,n=!1){if("function"!=typeof e)return void console.warn("watchEffect callback must be a function");const t={cb:e,cleanup:null};n&&(t.cleanup=l(e,h())),d.onChange.push(t)}};return n.add(g),g}}}